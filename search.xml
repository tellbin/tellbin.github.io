<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>chrome-devtools</title>
      <link href="/2019/09/19/415693982.html"/>
      <url>/2019/09/19/415693982.html</url>
      
        <content type="html"><![CDATA[<p>Java Client 使用示例</p><h4 id="maven-配置"><a href="#maven-配置" class="headerlink" title="maven 配置"></a>maven 配置</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.kklisura.cdt<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cdt-java-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="java-示例"><a href="#java-示例" class="headerlink" title="java 示例"></a>java 示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.hutool.core.thread.ThreadFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.RandomUtil;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.launch.ChromeLauncher;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.protocol.commands.Runtime;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.protocol.commands.*;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.protocol.types.network.ResourceType;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.protocol.types.network.Response;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.protocol.types.network.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.protocol.types.page.*;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.protocol.types.runtime.Evaluate;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.services.ChromeDevToolsService;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.services.ChromeService;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.services.config.ChromeDevToolsServiceConfiguration;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.services.executors.EventExecutorService;</span><br><span class="line"><span class="keyword">import</span> com.github.kklisura.cdt.services.types.ChromeTab;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * https://github.com/kklisura/chrome-devtools-java-client</span></span><br><span class="line"><span class="comment"> * https://chromedevtools.github.io/devtools-protocol</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;dependency&gt;</span></span><br><span class="line"><span class="comment"> * &lt;groupId&gt;com.github.kklisura.cdt&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment"> * &lt;artifactId&gt;cdt-java-client&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment"> * &lt;version&gt;2.0.0&lt;/version&gt;</span></span><br><span class="line"><span class="comment"> * &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChromeDevtoolsJavaClientTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> resultCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        ThreadFactory namedThreadFactory = <span class="keyword">new</span> ThreadFactoryBuilder()</span><br><span class="line">                .setNamePrefix(<span class="string">"demo-pool-%d"</span>).build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Common Thread Pool</span></span><br><span class="line">        ExecutorService pool = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">5</span>, <span class="number">200</span>,</span><br><span class="line">                <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(<span class="number">1024</span>), namedThreadFactory, <span class="keyword">new</span> ThreadPoolExecutor.AbortPolicy());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建chrome启动器</span></span><br><span class="line">        <span class="keyword">final</span> ChromeLauncher launcher = <span class="keyword">new</span> ChromeLauncher();</span><br><span class="line">        <span class="comment">// 以无头（true）或常规（false）方式启动chrome</span></span><br><span class="line">        <span class="keyword">final</span> ChromeService chromeService = launcher.launch(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建空标签，即：空白</span></span><br><span class="line">        <span class="keyword">final</span> ChromeTab tab = chromeService.createTab();</span><br><span class="line"></span><br><span class="line">        ChromeDevToolsServiceConfiguration chromeDevToolsServiceConfiguration = <span class="keyword">new</span> ChromeDevToolsServiceConfiguration();</span><br><span class="line">        chromeDevToolsServiceConfiguration.setEventExecutorService(<span class="keyword">new</span> EventExecutorService() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable runnable)</span> </span>&#123;</span><br><span class="line">                pool.execute(runnable);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                pool.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取DevTools服务到此选项卡</span></span><br><span class="line">        <span class="keyword">final</span> ChromeDevToolsService devToolsService = chromeService.createDevToolsService(tab, chromeDevToolsServiceConfiguration);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取单个命令</span></span><br><span class="line">        <span class="keyword">final</span> Page page = devToolsService.getPage();</span><br><span class="line">        <span class="keyword">final</span> DOM dom = devToolsService.getDOM();</span><br><span class="line">        <span class="keyword">final</span> Input input = devToolsService.getInput();</span><br><span class="line">        <span class="keyword">final</span> Network network = devToolsService.getNetwork();</span><br><span class="line">        <span class="keyword">final</span> Runtime runtime = devToolsService.getRuntime();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//阻止一些网址,加快访问速度(截图时注意不要阻隔图片或者样式)</span></span><br><span class="line">        <span class="comment">//network.setBlockedURLs(Arrays.asList("**/*.css", "**/*.png", "**/*.svg"));</span></span><br><span class="line">        network.setBlockedURLs(Arrays.asList(<span class="string">"**play.google.com**"</span>));</span><br><span class="line">        <span class="comment">// HTTP响应可用时触发</span></span><br><span class="line">        network.onResponseReceived(event -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (ResourceType.XHR != event.getType()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            Response response = event.getResponse();</span><br><span class="line">            String requestId = event.getRequestId();</span><br><span class="line">            ResponseBody responseBody = network.getResponseBody(requestId);</span><br><span class="line">            System.out.printf(</span><br><span class="line">                    <span class="string">"[%s]request: id=&gt;%s\t%s%s"</span>,</span><br><span class="line">                    getAddCount(),</span><br><span class="line">                    requestId,</span><br><span class="line">                    JSON.toJSONString(responseBody),</span><br><span class="line">                    System.lineSeparator());</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 加载事件被触发</span></span><br><span class="line">        page.onLoadEventFired(</span><br><span class="line">                event -&gt; &#123;</span><br><span class="line">                    log.info(<span class="string">"页面加载完成"</span>);</span><br><span class="line">                    <span class="comment">// 执行 javascript</span></span><br><span class="line">                    <span class="comment">//  Evaluate evaluation = runtime.evaluate("document.documentElement.outerHTML");</span></span><br><span class="line">                    <span class="comment">// System.out.println(evaluation.getResult().getValue());</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 截屏</span></span><br><span class="line">                    <span class="comment">// captureFullPageScreenshot(devToolsService, page, "screenshot.png");</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//保存至PDF</span></span><br><span class="line">                    <span class="comment">// printToPdf(devToolsService);</span></span><br><span class="line"><span class="comment">//                    Evaluate evaluate = runtime.evaluate(String.format("document.querySelector('#source').value='%s'", "hello"));</span></span><br><span class="line">                    <span class="comment">// log.error(JSON.toJSONString(evaluate.getExceptionDetails()));</span></span><br><span class="line">                    <span class="keyword">int</span> count = <span class="number">10</span>;</span><br><span class="line">                    <span class="keyword">while</span> (count-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        String key = RandomUtil.randomString(<span class="number">6</span>);</span><br><span class="line">                        Evaluate evaluate = runtime.evaluate(String.format(<span class="string">"document.querySelector('#source').value='%s'"</span>, key));</span><br><span class="line">                        <span class="comment">// log.error(JSON.toJSONString(evaluate.getExceptionDetails()));</span></span><br><span class="line"></span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            Thread.sleep(<span class="number">1000L</span>);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 启用页面事件</span></span><br><span class="line">        page.enable();</span><br><span class="line">        <span class="comment">// 启用网络事件</span></span><br><span class="line">        network.enable();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 导航到指定网址</span></span><br><span class="line">        page.navigate(<span class="string">"https://translate.google.cn"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 等到devtools关闭</span></span><br><span class="line">        devToolsService.waitUntilClosed();</span><br><span class="line">        <span class="comment">// 关闭标签</span></span><br><span class="line">        <span class="comment">//chromeService.closeTab(tab);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getAddCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++resultCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printToPdf</span><span class="params">(ChromeDevToolsService devToolsService)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Printing to PDF..."</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> String outputFilename = <span class="string">"test.pdf"</span>;</span><br><span class="line"></span><br><span class="line">        Boolean landscape = <span class="keyword">false</span>;</span><br><span class="line">        Boolean displayHeaderFooter = <span class="keyword">false</span>;</span><br><span class="line">        Boolean printBackground = <span class="keyword">false</span>;</span><br><span class="line">        Double scale = <span class="number">1</span>d;</span><br><span class="line">        <span class="comment">// A4 paper format</span></span><br><span class="line">        Double paperWidth = <span class="number">8.27</span>d;</span><br><span class="line">        <span class="comment">// A4 paper format</span></span><br><span class="line">        Double paperHeight = <span class="number">11.7</span>d;</span><br><span class="line">        Double marginTop = <span class="number">0</span>d;</span><br><span class="line">        Double marginBottom = <span class="number">0</span>d;</span><br><span class="line">        Double marginLeft = <span class="number">0</span>d;</span><br><span class="line">        Double marginRight = <span class="number">0</span>d;</span><br><span class="line">        String pageRanges = <span class="string">""</span>;</span><br><span class="line">        Boolean ignoreInvalidPageRanges = <span class="keyword">false</span>;</span><br><span class="line">        String headerTemplate = <span class="string">""</span>;</span><br><span class="line">        String footerTemplate = <span class="string">""</span>;</span><br><span class="line">        Boolean preferCSSPageSize = <span class="keyword">false</span>;</span><br><span class="line">        PrintToPDFTransferMode mode = PrintToPDFTransferMode.RETURN_AS_BASE_64;</span><br><span class="line">        PrintToPDF printToPDF = devToolsService.getPage()</span><br><span class="line">        .printToPDF(landscape, displayHeaderFooter, printBackground, scale, paperWidth, paperHeight, marginTop,</span><br><span class="line">         marginBottom, marginLeft, marginRight, pageRanges, ignoreInvalidPageRanges, headerTemplate,</span><br><span class="line">          footerTemplate, preferCSSPageSize, mode);</span><br><span class="line">        dump(outputFilename, printToPDF);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Done!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">captureFullPageScreenshot</span><span class="params">(ChromeDevToolsService devToolsService, Page page, String outputFilename)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Taking screenshot..."</span>);</span><br><span class="line">        <span class="keyword">final</span> LayoutMetrics layoutMetrics = page.getLayoutMetrics();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">double</span> width = layoutMetrics.getContentSize().getWidth();</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">double</span> height = layoutMetrics.getContentSize().getHeight();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> Emulation emulation = devToolsService.getEmulation();</span><br><span class="line">        emulation.setDeviceMetricsOverride(</span><br><span class="line">                Double.valueOf(width).intValue(), Double.valueOf(height).intValue(), <span class="number">1.0</span>d, Boolean.FALSE);</span><br><span class="line"></span><br><span class="line">        Viewport viewport = <span class="keyword">new</span> Viewport();</span><br><span class="line">        viewport.setScale(<span class="number">1</span>d);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// You can set offset with X, Y</span></span><br><span class="line">        viewport.setX(<span class="number">0</span>d);</span><br><span class="line">        viewport.setY(<span class="number">0</span>d);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Set a width, height of a page to take screenshot at</span></span><br><span class="line">        viewport.setWidth(width);</span><br><span class="line">        viewport.setHeight(height);</span><br><span class="line">        String data = page.captureScreenshot(CaptureScreenshotFormat.PNG, <span class="number">100</span>, viewport, Boolean.TRUE);</span><br><span class="line">        dump(outputFilename, data);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Done!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">dump</span><span class="params">(String fileName, PrintToPDF printToPDF)</span> </span>&#123;</span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            File file = <span class="keyword">new</span> File(fileName);</span><br><span class="line">            fileOutputStream = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">            fileOutputStream.write(Base64.getDecoder().decode(printToPDF.getData()));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (fileOutputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fileOutputStream.flush();</span><br><span class="line">                    fileOutputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">dump</span><span class="params">(String fileName, String data)</span> </span>&#123;</span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            File file = <span class="keyword">new</span> File(fileName);</span><br><span class="line">            fileOutputStream = <span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">            fileOutputStream.write(Base64.getDecoder().decode(data));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (fileOutputStream != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fileOutputStream.flush();</span><br><span class="line">                    fileOutputStream.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>参考资料:</p><blockquote><p><a href="https://github.com/kklisura/chrome-devtools-java-client" target="_blank" rel="noopener">https://github.com/kklisura/chrome-devtools-java-client</a></p></blockquote><blockquote><p><a href="https://chromedevtools.github.io/devtools-protocol" target="_blank" rel="noopener">https://chromedevtools.github.io/devtools-protocol</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> chrome-devtools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>读取javadoc注释</title>
      <link href="/2019/09/19/3568395611.html"/>
      <url>/2019/09/19/3568395611.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>maven添加tools引用</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>system<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">systemPath</span>&gt;</span>$&#123;java.home&#125;/../lib/tools.jar<span class="tag">&lt;/<span class="name">systemPath</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><blockquote><p>代码</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.io.FileUtil;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.sun.javadoc.ClassDoc;</span><br><span class="line"><span class="keyword">import</span> com.sun.javadoc.FieldDoc;</span><br><span class="line"><span class="keyword">import</span> com.sun.javadoc.RootDoc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.ParameterizedType;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JavaDoc的使用方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaDocUse</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> RootDoc rootDoc;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> JSONObject types = <span class="keyword">new</span> JSONObject();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        types.put(<span class="string">"class java.lang.String"</span>, <span class="string">"string"</span>);</span><br><span class="line">        types.put(<span class="string">"interface java.util.List"</span>, <span class="string">"array"</span>);</span><br><span class="line">        types.put(<span class="string">"class java.lang.Integer"</span>, <span class="string">"integer"</span>);</span><br><span class="line">        types.put(<span class="string">"class java.util.Date"</span>, <span class="string">"string"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 显示DocRoot中的基本信息</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resultJSONObject</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(JSONObject resultJSONObject)</span> <span class="keyword">throws</span> ClassNotFoundException, NoSuchFieldException </span>&#123;</span><br><span class="line">        ClassDoc[] classes = rootDoc.classes();</span><br><span class="line">        <span class="keyword">for</span> (ClassDoc classDoc : classes) &#123;</span><br><span class="line">            System.out.println(classDoc.name() +</span><br><span class="line">                    <span class="string">"类的注释:"</span> + classDoc.commentText());</span><br><span class="line">            Class&lt;?&gt; moduleType = Class.forName(classDoc.qualifiedTypeName());</span><br><span class="line">            FieldDoc[] fields = classDoc.fields(<span class="keyword">false</span>);</span><br><span class="line">            <span class="keyword">for</span> (FieldDoc fieldDoc : fields) &#123;</span><br><span class="line">                <span class="keyword">if</span> (fieldDoc.isStatic()) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 打印出属性上的注释</span></span><br><span class="line">                System.out.println(<span class="string">"类"</span></span><br><span class="line">                        + classDoc.name() + <span class="string">","</span></span><br><span class="line">                        + fieldDoc.name() +</span><br><span class="line">                        <span class="string">"属性注释:"</span></span><br><span class="line">                        + fieldDoc.commentText());</span><br><span class="line">                JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line"></span><br><span class="line">                jsonObject.put(<span class="string">"description"</span>, fieldDoc.commentText());</span><br><span class="line"><span class="comment">//                jsonObject.put("required", new JSONArray());</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                JSONObject jsonObject1 = <span class="keyword">new</span> JSONObject();</span><br><span class="line"></span><br><span class="line">                Field declaredField = moduleType.getDeclaredField(fieldDoc.name());</span><br><span class="line"></span><br><span class="line">                Class&lt;?&gt; declaredFieldType = declaredField.getType();</span><br><span class="line">                <span class="keyword">if</span> (types.containsKey(declaredFieldType.toString())) &#123;</span><br><span class="line">                    jsonObject.put(<span class="string">"type"</span>, types.getString(declaredFieldType.toString()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    jsonObject.put(<span class="string">"type"</span>, declaredFieldType.getSimpleName().toLowerCase());</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                java.lang.reflect.Type genericType = declaredField.getGenericType();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (genericType <span class="keyword">instanceof</span> ParameterizedType) &#123;</span><br><span class="line">                    ParameterizedType parameterizedType = (ParameterizedType) genericType;</span><br><span class="line"></span><br><span class="line">                    java.lang.reflect.Type[] fieldArgTypes = parameterizedType.getActualTypeArguments();</span><br><span class="line">                    <span class="keyword">for</span> (java.lang.reflect.Type fieldArgType : fieldArgTypes) &#123;</span><br><span class="line">                        Class fieldArgClass = (Class) fieldArgType;</span><br><span class="line">                        System.out.println(<span class="string">"泛型字段的类型："</span> + fieldArgClass);</span><br><span class="line">                        execute(fieldArgClass.getName(), jsonObject1);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!jsonObject1.isEmpty()) &#123;</span><br><span class="line">                    JSONObject jsonObject2  = <span class="keyword">new</span> JSONObject();</span><br><span class="line">                    jsonObject.put(<span class="string">"items"</span>,jsonObject2);</span><br><span class="line">                    jsonObject2.put(<span class="string">"type"</span>,<span class="string">"object"</span>);</span><br><span class="line">                    jsonObject2.put(<span class="string">"properties"</span>, jsonObject1);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                resultJSONObject.put(fieldDoc.name(), jsonObject);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            MethodDoc[] methodDocs = classDoc.methods();</span></span><br><span class="line"><span class="comment">//            for(MethodDoc methodDoc : methodDocs)&#123;</span></span><br><span class="line"><span class="comment">//                // 打印出方法上的注释</span></span><br><span class="line"><span class="comment">//                System.out.println("类"</span></span><br><span class="line"><span class="comment">//                        +classDoc.name()+","</span></span><br><span class="line"><span class="comment">//                        +methodDoc.name()+</span></span><br><span class="line"><span class="comment">//                        "方法注释:"</span></span><br><span class="line"><span class="comment">//                        +methodDoc.commentText());</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchFieldException, ClassNotFoundException </span>&#123;</span><br><span class="line">        JSONObject resultJSONObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line"></span><br><span class="line">        String javaPath0 = <span class="string">"com.infinibase.modular.system.model.DataMaster"</span>;</span><br><span class="line">        execute(javaPath0, resultJSONObject);</span><br><span class="line">        String javaPath1 = <span class="string">"com.infinibase.modular.bizdata.transfer.DataMasterDto"</span>;</span><br><span class="line">        execute(javaPath1, resultJSONObject);</span><br><span class="line"></span><br><span class="line">        System.out.println(resultJSONObject.toJSONString());</span><br><span class="line">        System.out.println(types.toJSONString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(String packagePath, JSONObject resultJSONObject)</span> <span class="keyword">throws</span> NoSuchFieldException, ClassNotFoundException </span>&#123;</span><br><span class="line">        String relPath = <span class="string">"C:\\Users\\Bin\\git\\xzsx\\wc-admin\\src\\main\\java\\"</span>;</span><br><span class="line">        String javaPath = String.format(<span class="string">"%s%s.java"</span>, relPath, packagePath.replaceAll(<span class="string">"\\."</span>, <span class="string">"\\\\"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!FileUtil.exist(javaPath)) &#123;</span><br><span class="line">            javaPath = javaPath.replaceAll(<span class="string">"wc-admin"</span>, <span class="string">"wc-core"</span>);</span><br><span class="line">            <span class="keyword">if</span> (!FileUtil.exist(javaPath)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        com.sun.tools.javadoc.Main.execute(<span class="keyword">new</span> String[]&#123;<span class="string">"-doclet"</span>,</span><br><span class="line">                Doclet.class.getName(),</span><br><span class="line">                <span class="string">"-encoding"</span>, <span class="string">"utf-8"</span>, <span class="string">"-classpath"</span>,</span><br><span class="line">                <span class="string">"C:\\Users\\Bin\\git\\xzsx\\wc-admin\\target\\classes"</span>, javaPath&#125;);</span><br><span class="line">        show(resultJSONObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Doclet</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">start</span><span class="params">(RootDoc rootDoc)</span> </span>&#123;</span><br><span class="line">            JavaDocUse.rootDoc = rootDoc;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 实用 </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>git相关</title>
      <link href="/2019/06/09/3345772630.html"/>
      <url>/2019/06/09/3345772630.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://git-scm.com/images/logo@2x.png" alt="git"></p><h3 id="基础操作"><a href="#基础操作" class="headerlink" title="基础操作"></a>基础操作</h3><blockquote><p>克隆</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone 克隆地址 [存储后的名称]</span><br></pre></td></tr></table></figure><blockquote><p>切换分支</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin master</span><br></pre></td></tr></table></figure><blockquote><p>删除缓存文件</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm -r --cached target</span><br></pre></td></tr></table></figure><a id="more"></a><blockquote><p>提交修改至本地</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m &apos;删除多余文件&apos;</span><br></pre></td></tr></table></figure><blockquote><p>推送至线上指定分支</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><hr><h3 id="gitignore-不起作用解决-重建本地缓存"><a href="#gitignore-不起作用解决-重建本地缓存" class="headerlink" title=".gitignore 不起作用解决(重建本地缓存)"></a>.gitignore 不起作用解决(重建本地缓存)</h3><blockquote><p>清除本地缓存</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm -r --cached .</span><br></pre></td></tr></table></figure><blockquote><p>添加前把不需要提交的文件(夹)删掉</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &apos;update .gitignore&apos;</span><br></pre></td></tr></table></figure><blockquote><p>.git 文件夹同级目录创建.gitignore 文件填入规则即可</p></blockquote><hr><h3 id="强制更新覆盖本地"><a href="#强制更新覆盖本地" class="headerlink" title="强制更新覆盖本地"></a>强制更新覆盖本地</h3><blockquote><p>出现冲突 放弃本地修改，使远程库内容强制覆盖本地代码</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure><blockquote><p>下载代码到本地，不进行合并操作</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch --all</span><br></pre></td></tr></table></figure><blockquote><p>把 HEAD 指向最新下载的版本</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard origin/master</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 基础 </tag>
            
            <tag> gitignore </tag>
            
            <tag> gitignore不起作用 </tag>
            
            <tag> 强制更新覆盖本地 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>maven源码包中文乱码</title>
      <link href="/2019/05/31/1874961768.html"/>
      <url>/2019/05/31/1874961768.html</url>
      
        <content type="html"><![CDATA[<p>通过maven下载源代码，直接通过eclipse浏览源代码时，发现中文注释为乱码的问题。其实这个eclipse默认编码造成的问题。可以通过以下方法解决：</p><h2 id="一、eclipse"><a href="#一、eclipse" class="headerlink" title="一、eclipse"></a>一、eclipse</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>Window-&gt;Preferences-&gt;General-&gt;Content Types</span><br><span class="line">   修改Java Archive(*.jar)编码为UTF<span class="number">-8</span></span><br><span class="line">   修改Java Class File编码为UTF<span class="number">-8</span></span><br><span class="line">   修改Text-&gt;Java Source File编码为UTF<span class="number">-8</span></span><br><span class="line">  注:Default encoding输入框中输入UTF<span class="number">-8</span>，点Update</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>File-&gt;Preferences-&gt;Workspace</span><br><span class="line">   修改Text file encoding编码为UTF<span class="number">-8</span></span><br></pre></td></tr></table></figure><a id="more"></a><hr><h2 id="二、maven"><a href="#二、maven" class="headerlink" title="二、maven"></a>二、maven</h2><p>pom.xml，加入一下内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><p>如果还是乱码，记得重启eclipse 。</p>]]></content>
      
      
      
        <tags>
            
            <tag> maven </tag>
            
            <tag> 源码 </tag>
            
            <tag> 中文 </tag>
            
            <tag> 乱码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux小命令合集</title>
      <link href="/2019/05/31/1843830742.html"/>
      <url>/2019/05/31/1843830742.html</url>
      
        <content type="html"><![CDATA[<h3 id="CentOS-安装lsof命令"><a href="#CentOS-安装lsof命令" class="headerlink" title="CentOS 安装lsof命令"></a>CentOS 安装lsof命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install lsof</span><br></pre></td></tr></table></figure><blockquote><p>使用</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -i:(端口号)</span><br></pre></td></tr></table></figure><a id="more"></a><hr><h3 id="CentOS-安装rz和sz命令"><a href="#CentOS-安装rz和sz命令" class="headerlink" title="CentOS 安装rz和sz命令"></a>CentOS 安装rz和sz命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install lrzsz</span><br></pre></td></tr></table></figure><hr><h3 id="centos7-显示中文"><a href="#centos7-显示中文" class="headerlink" title="centos7 显示中文"></a>centos7 显示中文</h3><blockquote><p>安装中文语言包：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum groupinstall chinese-support -y  没用 </span><br><span class="line">yum search chinese </span><br><span class="line">yum install -y kde-l10n-Chinese.noarch  用这个</span><br></pre></td></tr></table></figure><blockquote><p>修改locale.conf</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/locale.conf</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#LANG=&quot;en_US.UTF-8&quot;</span><br><span class="line">LANG=&quot;zh_CN.UTF-8&quot;</span><br></pre></td></tr></table></figure><blockquote><p>使设置生效 </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/locale.conf</span><br></pre></td></tr></table></figure><hr><h3 id="centos7-时间同步"><a href="#centos7-时间同步" class="headerlink" title="centos7 时间同步"></a>centos7 时间同步</h3><blockquote><p>安装ntp时间同步相关软件包</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install ntp  ntpdate</span><br></pre></td></tr></table></figure><blockquote><p>确认配置文件里有下列的时间同步源</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ntp.conf</span><br><span class="line"></span><br><span class="line">server 0.rhel.pool.ntp.org iburst</span><br><span class="line">server 1.rhel.pool.ntp.org iburst</span><br><span class="line">server 2.rhel.pool.ntp.org iburst</span><br><span class="line">server 3.rhel.pool.ntp.org iburst</span><br></pre></td></tr></table></figure><blockquote><p>设置开机自动启动ntpd</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable ntpd</span><br></pre></td></tr></table></figure><blockquote><p>立即启动ntpd服务</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start ntpd</span><br></pre></td></tr></table></figure><blockquote><p>确认时间与现在时间一致</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date</span><br></pre></td></tr></table></figure><hr><h3 id="centos7通过yum安装JDK1-8"><a href="#centos7通过yum安装JDK1-8" class="headerlink" title="centos7通过yum安装JDK1.8"></a>centos7通过yum安装JDK1.8</h3><blockquote><p>安装之前先检查一下系统有没有自带open-jdk<br>命令：</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa |grep java</span><br><span class="line">rpm -qa |grep jdk</span><br><span class="line">rpm -qa |grep gcj</span><br></pre></td></tr></table></figure><blockquote><p>如果没有输出信息表示没有安装。</p></blockquote><blockquote><p>如果安装可以使用</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep java | xargs rpm -e --nodeps</span><br></pre></td></tr></table></figure><blockquote><p>批量卸载所有带有Java的文件  这句命令的关键字是java</p></blockquote><blockquote><p>首先检索包含java的列表</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list java*</span><br></pre></td></tr></table></figure><blockquote><p>检索1.8的列表</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list java-1.8*</span><br></pre></td></tr></table></figure><blockquote><p>安装1.8.0的所有文件</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install java-1.8.0-openjdk* -y</span><br></pre></td></tr></table></figure><blockquote><p>使用命令检查是否安装成功</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure><blockquote><p>到此安装结束了。这样安装有一个好处就是不需要对path进行设置，自动就设置好了</p></blockquote><hr><h3 id="删除文件名是乱码或者带有特殊字符的文件"><a href="#删除文件名是乱码或者带有特殊字符的文件" class="headerlink" title="删除文件名是乱码或者带有特殊字符的文件"></a>删除文件名是乱码或者带有特殊字符的文件</h3><blockquote><p>先ls -i 查到文件的inode，然后用find命令删除</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[localhost]ls -ilrt</span><br><span class="line"></span><br><span class="line">100985 -rw-r--r--  1 tbcs      users            0 Apr 18 11:32 -MXV9.log</span><br></pre></td></tr></table></figure><blockquote><p>最前面一列的100985就是文件的inode，在主机上执行如下命令即可删除文件</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[localhost]find ./ -inum 100985 -<span class="built_in">exec</span> rm &#123;&#125; \;</span><br></pre></td></tr></table></figure><blockquote><p>这个方法适用于文件名为乱码或者带有特殊字符的文件删除</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 命令 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用网站&amp;软件记录</title>
      <link href="/2019/05/31/4104122682.html"/>
      <url>/2019/05/31/4104122682.html</url>
      
        <content type="html"><![CDATA[<h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><ul><li><a href="https://www.snipaste.com/" target="_blank" rel="noopener">Snipaste</a></li><li><a href="https://www.portablesoft.org/down/117/" target="_blank" rel="noopener">FSCapture</a></li><li><a href="https://www.cockos.com/licecap/" target="_blank" rel="noopener">LICEcap</a><a id="more"></a><h2 id="网站"><a href="#网站" class="headerlink" title="网站"></a>网站</h2><h3 id="软件-1"><a href="#软件-1" class="headerlink" title="软件"></a>软件</h3></li><li><a href="https://www.portablesoft.org/" target="_blank" rel="noopener">精品绿色便携软件</a></li><li><a href="https://www.iplaysoft.com/" target="_blank" rel="noopener">异次元软件世界</a></li></ul><h3 id="图标"><a href="#图标" class="headerlink" title="图标"></a>图标</h3><ul><li><a href="http://chuangzaoshi.com/icon" target="_blank" rel="noopener">草莓ICON</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 软件 </tag>
            
            <tag> 常用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Eclipse实用</title>
      <link href="/2019/05/31/962091219.html"/>
      <url>/2019/05/31/962091219.html</url>
      
        <content type="html"><![CDATA[<h3 id="注释模版"><a href="#注释模版" class="headerlink" title="注释模版"></a>注释模版</h3><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * @author XXX</span><br><span class="line"> * @date $&#123;currentDate:date(&apos;yyyy-MM-dd HH:mm:ss&apos;)&#125;</span><br><span class="line"> *</span><br><span class="line"> * $&#123;tags&#125; $&#123;return_type&#125;</span><br><span class="line"> */</span><br></pre></td></tr></table></figure><a id="more"></a><hr><h3 id="查看jar包源代码乱码问题解决-转载自：王崇安"><a href="#查看jar包源代码乱码问题解决-转载自：王崇安" class="headerlink" title="查看jar包源代码乱码问题解决(转载自：王崇安)"></a>查看jar包源代码乱码问题解决(转载自：<a href="http://wangchongan.com" target="_blank" rel="noopener">王崇安</a>)</h3><p>1.在eclipse菜单栏中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Window–&gt;Preferences–&gt;General–&gt;Content types</span><br></pre></td></tr></table></figure><p>将JAR Content ， Java Class File 的Default encoding都设置为你要的编码</p><p>2.光设置上面的还不行，还需要再设置Workspace的编码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Window–&gt;Preferences–&gt;General–&gt;Workspace</span><br></pre></td></tr></table></figure><p>将Text file encoding的默认编码也设置为和上面一致的编码。</p><hr><h3 id="文本文件默认打开编码-解决打开页面文件乱码问题"><a href="#文本文件默认打开编码-解决打开页面文件乱码问题" class="headerlink" title="文本文件默认打开编码(解决打开页面文件乱码问题)"></a>文本文件默认打开编码(解决打开页面文件乱码问题)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Windows-&gt;Perferences-&gt;General-&gt;Content Types-&gt;Text</span><br></pre></td></tr></table></figure><blockquote><p>然后将Default encoding设置为UTF-8即可<br>这样是把所有文本类型文件默认用UTF-8编码打开，可针对子文件类型指定默认编码</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Eclipse </tag>
            
            <tag> 实用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>html生成pdf几种方式</title>
      <link href="/2019/05/31/3291822591.html"/>
      <url>/2019/05/31/3291822591.html</url>
      
        <content type="html"><![CDATA[<h3 id="使用-chrome-devtools"><a href="#使用-chrome-devtools" class="headerlink" title="使用 chrome-devtools"></a>使用 chrome-devtools</h3><p><a href="/2019/09/19/415693982.html">chrome-devtools</a></p><hr><h3 id="wkhtmltopdf"><a href="#wkhtmltopdf" class="headerlink" title="wkhtmltopdf"></a>wkhtmltopdf</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\wkhtmltopdf http://localhost:7999/DZ.html test.pdf</span><br></pre></td></tr></table></figure><a id="more"></a><hr><h3 id="PhantomJS"><a href="#PhantomJS" class="headerlink" title="PhantomJS"></a>PhantomJS</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phantomjs.exe render_pdf.js http://localhost:7999/DZ.html d:/test.pdf</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/blowfishking/article/details/80802686" target="_blank" rel="noopener">render_pdf.js</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">"webpage"</span>).create(),</span><br><span class="line">  system = <span class="built_in">require</span>(<span class="string">"system"</span>),</span><br><span class="line">  address,</span><br><span class="line">  output,</span><br><span class="line">  size;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (system.args.length &lt; <span class="number">3</span> || system.args.length &gt; <span class="number">5</span>) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Usage: rasterize.js URL filename"</span>);</span><br><span class="line">  phantom.exit(<span class="number">1</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  address = system.args[<span class="number">1</span>];</span><br><span class="line">  output = system.args[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(page.settings.userAgent);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 不加分页的话，只输出一页pdf，底部会有大量空白。</span></span><br><span class="line">  <span class="comment">//google "phantomjs render pdf bottom blank" 可以看到别人也报过这种bug</span></span><br><span class="line">  <span class="comment">// 最终查找Phantomjs generates multiple page PDF 竟然解决了问题</span></span><br><span class="line">  page.paperSize = &#123; <span class="attr">format</span>: <span class="string">"A4"</span>, <span class="attr">orientation</span>: <span class="string">"portrait"</span>, <span class="attr">margin</span>: <span class="string">"0.8cm"</span> &#125;;</span><br><span class="line">  <span class="comment">// page.viewportSize = &#123; width: 600, height: 800 &#125;;</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"open page now"</span>);</span><br><span class="line">  page.open(address, <span class="function"><span class="keyword">function</span>(<span class="params">status</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(status);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//evaluate注册一个回调函数，页面加载完就执行。用来操作页面中的DOM元素</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改微信公众号文章中图片lazy load的方式</span></span><br><span class="line">    <span class="keyword">var</span> size = page.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//此函数在目标页面执行的，上下文环境非本phantomjs，所以不能用到这个js中其他变量</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">//这个控制台打印的效果在phantomjs执行界面看不到</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"start image lazy loading"</span>);</span><br><span class="line">      <span class="keyword">var</span> imgs = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"img"</span>);</span><br><span class="line">      <span class="keyword">var</span> size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">console</span>.log(size);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = imgs.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">var</span> data_src = imgs[i].getAttribute(<span class="string">"data-src"</span>);</span><br><span class="line">        <span class="keyword">if</span> (data_src) &#123;</span><br><span class="line">          imgs[i].setAttribute(<span class="string">"src"</span>, data_src);</span><br><span class="line">          size++;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> size;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"change lazy load img number:"</span> + size);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 预留一定的渲染时间</span></span><br><span class="line">    <span class="built_in">window</span>.setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      page.render(output);</span><br><span class="line">      page.close();</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"render ok"</span>);</span><br><span class="line">      phantom.exit();</span><br><span class="line">    &#125;, <span class="number">5000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// phantom.exit();</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> html </tag>
            
            <tag> pdf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySql更新表排名两种方式</title>
      <link href="/2019/05/31/3430843100.html"/>
      <url>/2019/05/31/3430843100.html</url>
      
        <content type="html"><![CDATA[<h3 id="并列排名"><a href="#并列排名" class="headerlink" title="并列排名"></a>并列排名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> test0 a,</span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">id</span>,</span><br><span class="line"><span class="keyword">num</span>,</span><br><span class="line">( <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>( * ) + <span class="number">1</span> <span class="keyword">FROM</span> test0 c <span class="keyword">WHERE</span> c.num &gt; test0.num ) pm </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">test0 </span><br><span class="line">) b </span><br><span class="line"><span class="keyword">SET</span> a.rank = b.pm </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">a.id = b.id</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="行号排名"><a href="#行号排名" class="headerlink" title="行号排名"></a>行号排名</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> test0 a</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">( @rno := @rno + <span class="number">1</span> ) <span class="keyword">AS</span> pm,</span><br><span class="line"><span class="keyword">id</span> </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">( <span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> test0 <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">num</span> <span class="keyword">DESC</span> ) c,</span><br><span class="line">( <span class="keyword">SELECT</span> @rno := <span class="number">0</span> ) d </span><br><span class="line">) b <span class="keyword">ON</span> b.id = a.id </span><br><span class="line"><span class="keyword">SET</span> a.rank = b.pm</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
